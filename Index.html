<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
  <title>Asad & Sania ¬∑ 3D Cartoon Love Story</title>
  <!-- Bootstrap 5 CDN (for layout and responsive UI) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Three.js library -->
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
      }
    }
  </script>
  <style>
    /* ----- GLOBAL CINEMATIC STYLES ----- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: #0a0f1e;
      color: white;
      overflow-x: hidden;
      position: relative;
      scroll-snap-type: y mandatory;
      overflow-y: scroll;
    }
    h1, h2, h3, .romantic-font {
      font-family: 'Playfair Display', serif;
    }
    /* Each scene: full viewport, flex column for overlay text, 3D canvas behind */
    .scene {
      min-height: 100vh;
      height: 100vh;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      padding: 1rem;
      scroll-snap-align: start;
      background-color: transparent;  /* canvas shows through */
      z-index: 1;
    }
    /* Overlay UI ‚Äì cards, text, buttons sit above 3D */
    .content-overlay {
      background: rgba(10, 15, 30, 0.65);
      backdrop-filter: blur(10px);
      border-radius: 40px;
      padding: 2rem;
      border: 1px solid rgba(255, 215, 215, 0.3);
      box-shadow: 0 20px 40px rgba(0,0,0,0.5);
      max-width: 600px;
      width: 90%;
      z-index: 10;
      color: white;
    }
    /* phone mock for chat scenes */
    .phone-mock {
      background: rgba(30, 30, 47, 0.9);
      backdrop-filter: blur(8px);
      border-radius: 36px;
      padding: 20px 15px;
      border: 1px solid #44475a;
      max-width: 420px;
      width: 100%;
    }
    .chat-bubble {
      background: #2e3b4e;
      padding: 12px 18px;
      border-radius: 24px 24px 24px 4px;
      margin: 10px 0;
      max-width: 80%;
      color: white;
    }
    .chat-bubble.right {
      background: #ff7b9c;
      align-self: flex-end;
      border-radius: 24px 24px 4px 24px;
    }
    /* progress bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: rgba(255,255,255,0.1);
      z-index: 2000;
    }
    .progress-bar-fill {
      height: 5px;
      width: 0%;
      background: linear-gradient(90deg, #ff9a9e, #fad0c4, #ffd1d1);
      transition: width 0.2s;
      box-shadow: 0 0 12px #ff9a9e;
    }
    /* control buttons */
    .story-controls {
      position: fixed;
      bottom: 25px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 15px;
      z-index: 2000;
      flex-wrap: wrap;
      padding: 0 15px;
    }
    .ctrl-btn {
      background: rgba(10, 15, 30, 0.8);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 215, 215, 0.4);
      color: white;
      padding: 12px 24px;
      border-radius: 50px;
      font-weight: 600;
      letter-spacing: 2px;
      font-size: 0.9rem;
      transition: 0.4s;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .ctrl-btn:hover {
      background: #ffb3c6;
      color: #1a1a2c;
    }
    .music-toggle {
      background: rgba(255, 123, 156, 0.2);
      border: 1px solid #ff7b9c;
    }
    /* 3D canvas pinned background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;  /* allow interaction with UI */
    }
    /* footer */
    footer {
      position: fixed;
      bottom: 100px;
      right: 20px;
      color: rgba(255,255,240,0.5);
      font-size: 0.8rem;
      z-index: 2000;
    }
    @media (max-width: 768px) {
      .content-overlay { padding: 1.5rem; }
    }
  </style>
</head>
<body>

  <!-- PROGRESS BAR -->
  <div class="progress-container">
    <div id="progressBar" class="progress-bar-fill"></div>
  </div>

  <!-- 3D Canvas (fixed background) -->
  <canvas id="three-canvas"></canvas>

  <!-- BACKGROUND MUSIC: afsoos.mp3 (autoplay muted) -->
  <audio id="bgAudio" loop autoplay muted preload="auto" style="display:none;">
    <source src="afsoos.mp3" type="audio/mpeg">
    Your browser does not support audio.
  </audio>

  <!-- ========== 8 SCENES ‚Äì Overlay content only ========== -->
  <div class="container-fluid px-0">

    <!-- SCENE 1 ‚Äì STARTING BANNER: HUG + SOCIAL MESSAGES (3D characters will hug) -->
    <section id="scene1" class="scene">
      <div class="content-overlay text-center">
        <div class="phone-mock fade-in mx-auto">
          <div class="d-flex flex-column">
            <div class="chat-bubble slide-left">Sania: hello ap Romeo</div>
            <div class="chat-bubble right slide-right">Asad: Han üòÇ üòÇ</div>
            <div class="chat-bubble slide-left">Sania: ya Roz confession ap per lag rhy h ku sad h</div>
            <div class="chat-bubble right slide-right">Asad: Han yar tang ho gya Hu ab choke my Beth k dant nikalu to iny yaqeen ho ga ni sad</div>
          </div>
        </div>
        <p class="mt-4 romantic-font" style="color:#ffe0f0;">‚ô° first chat & hug in 3D ‚ô°</p>
      </div>
      <div style="position: absolute; bottom: 20px; color: rgba(255,255,255,0.5); z-index:20;">Scene 1 ¬∑ 3D Hug</div>
    </section>

    <!-- SCENE 2 ‚Äì ACADEMY DAYS: Sania convinces Asad to do DIT -->
    <section id="scene2" class="scene">
      <div class="content-overlay text-center">
        <h3 class="romantic-font" style="color:#ffd9e8;">üéì Academy Days</h3>
        <p style="font-size:1.5rem;" class="zoom-in"><i class="fas fa-comment-dots"></i> ‚ÄúSania convinced Asad to join DIT‚Äù</p>
        <p style="color:#ffe0f0;">They started studying together every day.</p>
        <div style="font-size:2rem; color:#ff99aa;"><i class="fas fa-heart"></i></div>
      </div>
    </section>

    <!-- SCENE 3 ‚Äì ONE-SIDED LOVE: Asad loves her, fights about male friends -->
    <section id="scene3" class="scene">
      <div class="content-overlay text-center">
        <i class="fas fa-heart fa-3x" style="color:#ff6b7c;"></i>
        <h2 class="romantic-font mt-2">Asad fell one-sided love</h2>
        <p>Sania just considers him a friend.</p>
        <div class="row mt-3">
          <div class="col-6"><i class="fas fa-users fa-2x"></i><br>Male friends</div>
          <div class="col-6"><i class="fas fa-fist-raised fa-2x"></i><br>Fights & jealousy</div>
        </div>
        <span style="font-size:2rem; color:#b78c9c;">üíî</span>
      </div>
    </section>

    <!-- SCENE 4 ‚Äì DEPRESSION PHASE -->
    <section id="scene4" class="scene">
      <div class="content-overlay text-center">
        <i class="fas fa-user fa-4x" style="color:#565a75;"></i>
        <h2 class="romantic-font mt-3" style="color:#b3c7e5;">‚ÄúSometimes love hurts silently.‚Äù</h2>
        <p>Asad sits alone ...</p>
        <i class="fas fa-cloud-rain fa-3x" style="color:#62728f;"></i>
      </div>
    </section>

    <!-- SCENE 5 ‚Äì UNIVERSITY (3 years together, different depts, meet daily, madly in love) -->
    <section id="scene5" class="scene">
      <div class="content-overlay text-center">
        <h1 id="yearTimeline" class="display-4 romantic-font" style="color:#ffeabf;">3 Years Together</h1>
        <div class="row mt-3">
          <div class="col-4"><i class="fas fa-university fa-2x"></i><br>Same Uni</div>
          <div class="col-4"><i class="fas fa-code-branch fa-2x"></i><br>Different Depts</div>
          <div class="col-4"><i class="fas fa-calendar-alt fa-2x"></i><br>Meet daily</div>
        </div>
        <p class="mt-3" style="color:#ffdab9;">Asad loves her madly, silently.</p>
        <div><i class="fas fa-heart" style="color:#ff8c9a;"></i></div>
      </div>
    </section>

    <!-- SCENE 6 ‚Äì SEPARATION: She left Asad for his friend/class fellow. 3D animation: walk away -->
    <section id="scene6" class="scene">
      <div class="content-overlay text-center">
        <h3 class="romantic-font" style="color:#dedee3;">‚ÄúShe chose someone else...‚Äù</h3>
        <div class="row mt-4">
          <div class="col-4"><i class="fas fa-walking fa-3x"></i><br>Sania walks away</div>
          <div class="col-4"><i class="fas fa-user fa-3x"></i><br>...with him</div>
          <div class="col-4"><i class="fas fa-user fa-3x"></i><br>Asad watches</div>
        </div>
        <p class="mt-4" style="color:#ffb7b7;">She didn't look back.</p>
      </div>
    </section>

    <!-- SCENE 7 ‚Äì RECONNECTION (After 2 Years) -->
    <section id="scene7" class="scene">
      <div class="content-overlay text-center">
        <div class="phone-mock mx-auto" style="background: #fff1e6; color: #3a2a2a;">
          <i class="fas fa-bell fa-2x glow-effect" style="color:#c9714b;"></i>
          <p class="mt-2">Social media notification</p>
          <div class="chat-bubble" style="background:#ffd7ba;">Sania: Hey, long time ‚ù§Ô∏è</div>
          <div class="chat-bubble right" style="background:#faa38b;">Asad: I missed you...</div>
        </div>
        <h4 class="mt-4 romantic-font" style="color:#7f4f3c;">After 2 years‚Ä¶ destiny reconnects them.</h4>
      </div>
    </section>

    <!-- SCENE 8 ‚Äì WEDDING ENDING -->
    <section id="scene8" class="scene">
      <div class="content-overlay text-center" style="background: rgba(255,215,0,0.2); backdrop-filter: blur(12px); border-color: gold;">
        <i class="fas fa-heart fa-4x" style="color:#c92a4b; animation: heartbeat 1.5s infinite;"></i>
        <h1 class="romantic-font display-4" style="color:#4a2c2c;">Asad & Sania</h1>
        <h3 style="color:#644117;">üíç finally together</h3>
        <div class="mt-4 fade-in">
          <p style="font-size:1.6rem; font-weight:600; color:#34200c;">‚ÄúSome love stories are delayed‚Ä¶<br> but never denied.‚Äù</p>
        </div>
      </div>
    </section>
  </div>

  <!-- CONTROL BUTTONS -->
  <div class="story-controls">
    <button id="playStoryBtn" class="ctrl-btn"><i class="fas fa-play"></i> Play Story</button>
    <button id="prevSceneBtn" class="ctrl-btn"><i class="fas fa-arrow-left"></i> Prev</button>
    <button id="nextSceneBtn" class="ctrl-btn"><i class="fas fa-arrow-right"></i> Next</button>
    <button id="musicToggleBtn" class="ctrl-btn music-toggle"><i class="fas fa-music"></i> ‚ô´ Afsos (muted)</button>
  </div>

  <footer>‚ù§Ô∏è love is timeless</footer>

  <!-- THREE.JS SCRIPT: 3D Cartoon Animation -->
  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    // --- Setup Scene, Camera, Renderer ---
    const canvas = document.getElementById('three-canvas');
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x0a0f1e); // deep night

    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(5, 4, 12);
    camera.lookAt(0, 1, 0);

    const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;

    // --- Lights ---
    const ambientLight = new THREE.AmbientLight(0x404060);
    scene.add(ambientLight);

    const mainLight = new THREE.DirectionalLight(0xffeedd, 1);
    mainLight.position.set(5, 10, 7);
    mainLight.castShadow = true;
    mainLight.receiveShadow = true;
    mainLight.shadow.mapSize.width = 1024;
    mainLight.shadow.mapSize.height = 1024;
    scene.add(mainLight);

    const fillLight = new THREE.PointLight(0x4466aa, 0.5);
    fillLight.position.set(-5, 2, 5);
    scene.add(fillLight);

    // --- Ground (soft glow) ---
    const groundGeometry = new THREE.CircleGeometry(30, 32);
    const groundMaterial = new THREE.MeshStandardMaterial({ color: 0x1a1e30, roughness: 0.8, metalness: 0.1, side: THREE.DoubleSide });
    const ground = new THREE.Mesh(groundGeometry, groundMaterial);
    ground.rotation.x = -Math.PI / 2;
    ground.position.y = -0.5;
    ground.receiveShadow = true;
    scene.add(ground);

    // --- Helper grid (optional, but gives 3D feel) ---
    const gridHelper = new THREE.GridHelper(30, 20, 0x8899aa, 0x445566);
    gridHelper.position.y = -0.49;
    scene.add(gridHelper);

    // --- Create 3D Cartoon Characters (Asad & Sania) ---
    // Asad: blue theme, Sania: pink/purple theme

    function createCharacter(color, pos, name) {
      const group = new THREE.Group();
      group.position.copy(pos);

      // Body (cylinder)
      const bodyGeo = new THREE.CylinderGeometry(0.6, 0.6, 1.2, 8);
      const bodyMat = new THREE.MeshStandardMaterial({ color, roughness: 0.4, emissive: new THREE.Color(0x222222), emissiveIntensity: 0.1 });
      const body = new THREE.Mesh(bodyGeo, bodyMat);
      body.castShadow = true;
      body.receiveShadow = true;
      body.position.y = 0.6;
      group.add(body);

      // Head (sphere)
      const headGeo = new THREE.SphereGeometry(0.4, 32, 16);
      const headMat = new THREE.MeshStandardMaterial({ color: 0xffddbb, roughness: 0.3 });
      const head = new THREE.Mesh(headGeo, headMat);
      head.castShadow = true;
      head.receiveShadow = true;
      head.position.y = 1.6;
      group.add(head);

      // Eyes (white + black)
      const eyeWhiteGeo = new THREE.SphereGeometry(0.12, 16, 8);
      const eyeWhiteMat = new THREE.MeshStandardMaterial({ color: 0xffffff });
      const eyeL = new THREE.Mesh(eyeWhiteGeo, eyeWhiteMat);
      eyeL.position.set(-0.15, 1.75, 0.35);
      group.add(eyeL);
      const eyeR = new THREE.Mesh(eyeWhiteGeo, eyeWhiteMat);
      eyeR.position.set(0.15, 1.75, 0.35);
      group.add(eyeR);

      const pupilGeo = new THREE.SphereGeometry(0.06, 8, 4);
      const pupilMat = new THREE.MeshStandardMaterial({ color: 0x222222 });
      const pupilL = new THREE.Mesh(pupilGeo, pupilMat);
      pupilL.position.set(-0.15, 1.72, 0.5);
      group.add(pupilL);
      const pupilR = new THREE.Mesh(pupilGeo, pupilMat);
      pupilR.position.set(0.15, 1.72, 0.5);
      group.add(pupilR);

      // Nose (tiny sphere)
      const noseGeo = new THREE.SphereGeometry(0.06, 8, 4);
      const noseMat = new THREE.MeshStandardMaterial({ color: 0xffaa88 });
      const nose = new THREE.Mesh(noseGeo, noseMat);
      nose.position.set(0, 1.6, 0.5);
      group.add(nose);

      // Hair / hat to differentiate
      if (name === 'asad') {
        const hairGeo = new THREE.ConeGeometry(0.4, 0.2, 8);
        const hairMat = new THREE.MeshStandardMaterial({ color: 0x4a3c31 });
        const hair = new THREE.Mesh(hairGeo, hairMat);
        hair.position.y = 1.9;
        hair.rotation.x = 0.1;
        group.add(hair);
      } else {
        // Sania: bow or ponytail (simple sphere)
        const bowGeo = new THREE.TorusGeometry(0.15, 0.05, 4, 20, Math.PI);
        const bowMat = new THREE.MeshStandardMaterial({ color: 0xff69b4 });
        const bow = new THREE.Mesh(bowGeo, bowMat);
        bow.position.y = 2.0;
        bow.position.x = 0.2;
        bow.rotation.z = 0.5;
        bow.rotation.x = 0.3;
        group.add(bow);
        const bow2 = bow.clone();
        bow2.position.x = -0.2;
        bow2.rotation.z = -0.5;
        group.add(bow2);
      }

      return group;
    }

    const asad = createCharacter(0x4a90e2, new THREE.Vector3(-2, 0, 0), 'asad');
    const sania = createCharacter(0xff7b9c, new THREE.Vector3(2, 0, 0), 'sania');
    scene.add(asad);
    scene.add(sania);

    // --- Additional 3D elements: hearts, books, etc. ---
    const hearts = [];
    function createHeart(pos) {
      const heartGroup = new THREE.Group();
      const geo = new THREE.SphereGeometry(0.15, 8, 8);
      const mat = new THREE.MeshStandardMaterial({ color: 0xff4d6d, emissive: 0x330000, emissiveIntensity: 0.3 });
      const left = new THREE.Mesh(geo, mat);
      left.position.set(-0.15, 0, 0);
      heartGroup.add(left);
      const right = new THREE.Mesh(geo, mat);
      right.position.set(0.15, 0, 0);
      heartGroup.add(right);
      const bottom = new THREE.Mesh(new THREE.ConeGeometry(0.2, 0.3, 8), mat);
      bottom.position.set(0, -0.2, 0);
      bottom.rotation.x = Math.PI;
      bottom.rotation.z = 0;
      heartGroup.add(bottom);
      heartGroup.position.copy(pos);
      return heartGroup;
    }

    // --- Animation state per scene ---
    let currentScene = 0;
    const scenes = document.querySelectorAll('.scene');

    function update3DScene(index) {
      // Reset all animations/positions
      asad.position.set(-2, 0, 0);
      sania.position.set(2, 0, 0);
      asad.rotation.y = 0;
      sania.rotation.y = 0;
      asad.scale.set(1,1,1);
      sania.scale.set(1,1,1);
      // remove floating hearts etc.
      hearts.forEach(h => scene.remove(h));
      hearts.length = 0;

      switch(index) {
        case 0: // Scene 1: hug
          asad.position.set(-1.2, 0, 0);
          sania.position.set(1.2, 0, 0);
          asad.rotation.y = 0.3;
          sania.rotation.y = -0.3;
          // move closer gradually (hug animation via interval later)
          break;
        case 1: // Academy: sit side by side
          asad.position.set(-1.5, 0, 0.5);
          sania.position.set(1.5, 0, 0.5);
          // books
          break;
        case 2: // One-sided love: heart near Asad, sad expression
          asad.position.set(-1.8, 0, 0);
          sania.position.set(1.8, 0, 0);
          sania.rotation.y = -0.4; // looking away
          // broken heart later
          break;
        case 3: // Depression: Asad alone, rain (particles)
          sania.position.set(10,0,0); // hide sania
          asad.position.set(0,0,0);
          asad.rotation.y = 0;
          break;
        case 4: // University: both facing forward, heart float
          asad.position.set(-1.8, 0, 0);
          sania.position.set(1.8, 0, 0);
          asad.rotation.y = 0.2;
          sania.rotation.y = -0.2;
          // add floating hearts
          for (let i=0;i<5;i++) {
            let h = createHeart(new THREE.Vector3(-1 + i*0.5, 2, -1));
            scene.add(h);
            hearts.push(h);
          }
          break;
        case 5: // Separation: Sania walks left with another guy (add temp figure)
          asad.position.set(2, 0, 1);
          sania.position.set(-2, 0, 0);
          // add a basic male figure for "him"
          const otherGuy = createCharacter(0x6b7c8a, new THREE.Vector3(-3, 0, 0.2), 'other');
          otherGuy.name = 'otherGuy';
          // remove previous other guy if exists
          const old = scene.getObjectByName('otherGuy');
          if (old) scene.remove(old);
          scene.add(otherGuy);
          sania.rotation.y = 0.8;
          otherGuy.rotation.y = 0.5;
          asad.rotation.y = -0.3;
          break;
        case 6: // Reconnection: chat, both face each other
          asad.position.set(-1.5, 0, 0);
          sania.position.set(1.5, 0, 0);
          asad.rotation.y = 0.5;
          sania.rotation.y = -0.5;
          break;
        case 7: // Wedding: together, golden light, confetti in 3D
          asad.position.set(-0.8, 0, 0);
          sania.position.set(0.8, 0, 0);
          asad.rotation.y = 0.3;
          sania.rotation.y = -0.3;
          // add many hearts
          for (let i=0;i<12;i++) {
            let h = createHeart(new THREE.Vector3(-3 + i*0.6, 1.5, -2));
            scene.add(h);
            hearts.push(h);
          }
          break;
        default: break;
      }
    }

    // Intersection Observer to change 3D scene based on visible scene
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.id;
          const index = parseInt(id.replace('scene','')) - 1;
          currentScene = index;
          update3DScene(index);
        }
      });
    }, { threshold: 0.5 });

    scenes.forEach(sceneEl => observer.observe(sceneEl));

    // --- Animation loop ---
    function animate() {
      requestAnimationFrame(animate);

      // subtle idle animation: characters bob slightly
      const time = Date.now() * 0.002;
      if (asad) asad.position.y = Math.sin(time) * 0.05;
      if (sania) sania.position.y = Math.cos(time + 2) * 0.05;

      // scene-specific animations
      if (currentScene === 0) {
        // hug: slowly move closer
        asad.position.x += ( -1.0 - asad.position.x) * 0.03;
        sania.position.x += ( 1.0 - sania.position.x) * 0.03;
      }
      if (currentScene === 5) {
        // separation: walk away
        const other = scene.getObjectByName('otherGuy');
        if (other) {
          other.position.x -= 0.02;
          sania.position.x -= 0.02;
        }
      }
      if (currentScene === 7) {
        // rotate hearts
        hearts.forEach((h, i) => {
          h.rotation.y += 0.01;
          h.rotation.x += 0.005;
        });
      }

      renderer.render(scene, camera);
    }
    animate();

    // --- Resize handler ---
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // initial update
    update3DScene(0);
  </script>

  <!-- vanilla JS for UI controls, progress bar, music etc. (non-module) -->
  <script>
    (function() {
      // Scene scroll buttons
      const scenes = document.querySelectorAll('.scene');
      const nextBtn = document.getElementById('nextSceneBtn');
      const prevBtn = document.getElementById('prevSceneBtn');
      const playBtn = document.getElementById('playStoryBtn');

      function scrollToScene(index) {
        if (index >= 0 && index < scenes.length) {
          scenes[index].scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      let currentSceneIndex = 0;
      function updateCurrentScene() {
        const viewportMid = window.scrollY + window.innerHeight/2;
        scenes.forEach((sc, i) => {
          const rect = sc.getBoundingClientRect();
          const absTop = rect.top + window.scrollY;
          if (viewportMid >= absTop && viewportMid <= absTop + rect.height) {
            currentSceneIndex = i;
          }
        });
      }
      window.addEventListener('scroll', updateCurrentScene);
      
      nextBtn.addEventListener('click', () => scrollToScene(currentSceneIndex + 1));
      prevBtn.addEventListener('click', () => scrollToScene(currentSceneIndex - 1));
      playBtn.addEventListener('click', () => scrollToScene(0));

      // Progress bar
      const progressFill = document.getElementById('progressBar');
      function updateProgress() {
        const scrollY = window.scrollY;
        const totalHeight = document.body.scrollHeight - window.innerHeight;
        const progress = (scrollY / totalHeight) * 100;
        progressFill.style.width = progress + '%';
      }
      window.addEventListener('scroll', updateProgress);

      // Music Toggle for afsoos.mp3
      const musicBtn = document.getElementById('musicToggleBtn');
      const audio = document.getElementById('bgAudio');
      musicBtn.innerHTML = '<i class="fas fa-music"></i> ‚ô´ Afsos (muted)';
      musicBtn.addEventListener('click', function() {
        if (audio.muted) {
          audio.muted = false;
          audio.play().catch(e => console.log('interaction needed'));
          musicBtn.innerHTML = '<i class="fas fa-music"></i> ‚ô´ Afsos (playing)';
        } else {
          audio.muted = true;
          audio.pause();
          musicBtn.innerHTML = '<i class="fas fa-music"></i> ‚ô´ Afsos (muted)';
        }
      });

      updateCurrentScene();
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
